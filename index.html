<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Bubble Pop Relax Game</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
    }

    body {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle at top, #38bdf8, #0f172a);
      color: #e5e7eb;
    }

    .game {
      width: 100%;
      max-width: 500px;
      height: 80vh;
      max-height: 650px;
      background: rgba(15, 23, 42, 0.9);
      border-radius: 22px;
      padding: 16px 18px;
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.5);
      display: flex;
      flex-direction: column;
      position: relative;
      overflow: hidden;
    }

    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .title {
      font-size: 1.2rem;
      font-weight: 700;
    }

    .score {
      font-size: 0.9rem;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(15, 118, 110, 0.32);
      border: 1px solid rgba(45, 212, 191, 0.7);
    }

    .subtitle {
      font-size: 0.8rem;
      opacity: 0.8;
      margin-bottom: 10px;
    }

    .controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      margin-bottom: 8px;
    }

    .btn {
      padding: 7px 14px;
      border-radius: 999px;
      border: none;
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.16s ease-out;
    }

    .btn-primary {
      background: linear-gradient(to right, #22c55e, #06b6d4);
      color: white;
      flex: 1;
      text-align: center;
    }

    .btn-primary:hover {
      filter: brightness(1.07);
      transform: translateY(-1px);
      box-shadow: 0 10px 18px rgba(34, 197, 94, 0.4);
    }

    .btn-ghost {
      background: transparent;
      border: 1px solid rgba(148, 163, 184, 0.7);
      color: #e5e7eb;
    }

    .hint {
      font-size: 0.78rem;
      opacity: 0.75;
    }

    .play-area {
      flex: 1;
      margin-top: 4px;
      border-radius: 18px;
      background: radial-gradient(circle at bottom, #0f172a, #020617);
      border: 1px solid rgba(30, 64, 175, 0.7);
      position: relative;
      overflow: hidden;
    }

    .bubble {
      position: absolute;
      bottom: -120px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, #e0f2fe, #38bdf8);
      box-shadow: 0 0 12px rgba(56, 189, 248, 0.6);
      opacity: 0.9;
      cursor: pointer;
      animation-name: floatUp;
      animation-timing-function: linear;
      animation-fill-mode: forwards;
    }

    @keyframes floatUp {
      0% {
        transform: translateY(0) scale(1);
        opacity: 0.95;
      }
      100% {
        transform: translateY(-120vh) scale(0.9);
        opacity: 0;
      }
    }

    .bubble.popped {
      animation: pop 0.25s ease-out forwards;
      box-shadow: 0 0 20px rgba(250, 250, 250, 0.9);
    }

    @keyframes pop {
      0% {
        transform: scale(1);
        opacity: 1;
      }
      100% {
        transform: scale(1.7);
        opacity: 0;
      }
    }

    .float-text {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      font-size: 0.9rem;
      opacity: 0.6;
      pointer-events: none;
      text-align: center;
    }

    .relax-message {
      font-size: 0.85rem;
      margin-top: 4px;
      opacity: 0.85;
    }

    .relax-message strong {
      color: #6ee7b7;
    }
  </style>
</head>
<body>
  <div class="game">
    <div class="top-bar">
      <div class="title">Bubble Pop Relax</div>
      <div class="score" id="scoreDisplay">Popped: 0</div>
    </div>

    <div class="subtitle">
      No timer, no losing. Just pop bubbles and relax. üåä
    </div>

    <div class="controls">
      <button class="btn btn-primary" id="toggleBtn">Start</button>
      <button class="btn btn-ghost" id="clearBtn">Clear bubbles</button>
    </div>

    <div class="hint">
      Tip: Put on some lo-fi music and just tap slowly. üíÜ‚Äç‚ôÇÔ∏è
    </div>

    <div class="play-area" id="playArea">
      <div class="float-text" id="centerText">
        Tap <strong>Start</strong> and pop the bubbles calmly.
      </div>
    </div>

    <div class="relax-message">
      Mode: <strong>Chill</strong> ‚Äì score is just for fun, don't worry about it.
    </div>
  </div>

  <script>
    const playArea = document.getElementById("playArea");
    const scoreDisplay = document.getElementById("scoreDisplay");
    const toggleBtn = document.getElementById("toggleBtn");
    const clearBtn = document.getElementById("clearBtn");
    const centerText = document.getElementById("centerText");

    let isRunning = false;
    let bubbleInterval = null;
    let score = 0;
    let audioCtx = null;

    function updateScore() {
      scoreDisplay.textContent = "Popped: " + score;
    }

    function createBubble() {
      const areaRect = playArea.getBoundingClientRect();
      const bubble = document.createElement("div");
      bubble.className = "bubble";

      const size = 30 + Math.random() * 60; // 30‚Äì90 px
      bubble.style.width = size + "px";
      bubble.style.height = size + "px";

      // random horizontal position
      const maxLeft = areaRect.width - size;
      const left = Math.random() * maxLeft;
      bubble.style.left = left + "px";

      // random duration
      const duration = 7 + Math.random() * 6; // 7‚Äì13s
      bubble.style.animationDuration = duration + "s";

      // optional small horizontal drift
      const randomDelay = Math.random() * 2;
      bubble.style.animationDelay = randomDelay + "s";

      bubble.addEventListener("click", () => {
        popBubble(bubble);
      });

      // remove when animation ends (in case user doesn't click)
      bubble.addEventListener("animationend", () => {
        if (bubble.parentNode === playArea) {
          playArea.removeChild(bubble);
        }
      });

      playArea.appendChild(bubble);
    }

    function popBubble(bubble) {
      // already popped
      if (bubble.classList.contains("popped")) return;

      bubble.classList.add("popped");
      score++;
      updateScore();
      playPopSound();

      setTimeout(() => {
        if (bubble.parentNode === playArea) {
          playArea.removeChild(bubble);
        }
      }, 250);
    }

    // Simple soft pop sound
    function playPopSound() {
      try {
        if (!audioCtx) {
          audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        }
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();

        const now = audioCtx.currentTime;
        osc.frequency.setValueAtTime(500, now);
        osc.frequency.exponentialRampToValueAtTime(900, now + 0.1);

        gain.gain.setValueAtTime(0.0001, now);
        gain.gain.exponentialRampToValueAtTime(0.25, now + 0.03);
        gain.gain.exponentialRampToValueAtTime(0.0001, now + 0.18);

        osc.type = "sine";
        osc.connect(gain);
        gain.connect(audioCtx.destination);

        osc.start(now);
        osc.stop(now + 0.2);
      } catch (e) {
        // ignore audio errors
      }
    }

    function startRelaxMode() {
      if (isRunning) return;
      isRunning = true;
      toggleBtn.textContent = "Pause";
      centerText.style.opacity = 0.15;
      centerText.innerHTML = "Breathe in... breathe out... and tap bubbles slowly.";

      // spawn some bubbles instantly
      for (let i = 0; i < 4; i++) {
        setTimeout(createBubble, i * 300);
      }

      bubbleInterval = setInterval(() => {
        createBubble();
      }, 900);
    }

    function stopRelaxMode() {
      isRunning = false;
      toggleBtn.textContent = "Start";
      centerText.style.opacity = 0.6;
      centerText.innerHTML = "Tap <strong>Start</strong> and pop the bubbles calmly.";
      if (bubbleInterval) {
        clearInterval(bubbleInterval);
        bubbleInterval = null;
      }
    }

    function clearBubbles() {
      const bubbles = playArea.querySelectorAll(".bubble");
      bubbles.forEach((b) => playArea.removeChild(b));
    }

    toggleBtn.addEventListener("click", () => {
      if (!isRunning) {
        startRelaxMode();
      } else {
        stopRelaxMode();
      }
    });

    clearBtn.addEventListener("click", () => {
      clearBubbles();
    });

    // init score text
    updateScore();
  </script>
</body>
</html>
